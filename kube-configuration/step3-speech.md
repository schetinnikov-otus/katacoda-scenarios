Использовать созданные ConfigMap и Secret возможно следующим образом: передавать значения из ConfigMap/Secret в виде переменных окружения, либо передавать значения из Configmap/Secret в виде примонтированной директории внутрь контейнера. 

Рассмотрим первый способ.  Получение значений переменных окружения из конфигмапов и секретов. 

**Обновим deployment.yaml** 

Как видим, теперь внутри env вместо value используется параметр valueFrom, который позволяет получить значение произвольного параметра из конфигмапы или секрета. 

**Применим манифест**

**Во втором терминале** дожидаемся, пока деплоймент раскатится.

Раскатился. 

Теперь можем убедиться, что конфигурация действительно берется из СonfigMap и Secret.

**Делаем запрос к сервису**

Видим, что данные теперь берутся из конфигмапа и секрета. 

Теперь посмотрим, как работает второй способ, т.е. как можно примонтировать ConfigMap внутрь пода, как директорию. В этом случае каждый файл в директории будет соответствовать одному параметру - имя файла в качества ключа, а содержимое файла - это значение.

**Создадим файл mountconfig.yaml**

Это обычный конфигмап, с тремя параметрами test.json, my.cfg, .env

**Применим mountconfig.yaml**

Спецификация пода позволяет описывать и использовать хранилища.  Чтобы примонтировать внутрь пода конфигмап, нам нужно определить хранилище (volume) в спецификации пода, а потом на уже уровне контейнера описать точку монтирования. 

**Давайте обновим файл deployment.yaml** 

Хранилища у нас описываются на уровне спецификации пода (spec) в атрибуте volumes. Мы описываем хранилище mount-config, которое будет создано из конфигмапы с именем mount-config. 

На уровне контейнера в атрибует volumeMounts мы описываем точку монтирования хранилищ, т.е. в данном случае вольюм mount-config должен быть примонтирован в директорию /tmp/config. 

Итак, **применяем манифест.** 

**Во втором терминале** ждем окончания раскатки.

Все, раскатилось. 

Откроем третий терминал. И зайдем в поду деплоймента с помощью команды kubectl exec

Нажимаем команду 2 раза. **Сначала откроется новый терми**нал, потом **запустится команда.** 

**Посмотрим, как выглядит директория** /tmp/config. 

Видим там файлы, каждый файл соответствует одному параметру в конфигмапе. 

**Теперь можем посмотреть содержимое**

Содержимое соответвует значениям из конфигмапы. 

В случае, если поменяются значения в ConfigMap/Secret они автоматически НЕ будут обновлены, в случае использования в виде переменных окружения. Kubelet при создании проверяет, что нужный ConfigMap/Secret есть и передает в качестве переменных окружений конфигурацию оттуда. В случае использования Configmap/Secret как примонтированного директории в контейнере, kubelet периодически обновляет данные. И при изменения ConfigMap/Secret эти изменения там отразятся. Но в любом случае приложение должно уметь перечитывать и определять изменения из конфигурации.

Если мы с вами изменим ConfigMap, то через некоторое время изменения применятся и файлы внутри *пода* изменятся

**Меняем файл mountconfig.yaml**

**Применим манифест:**

Через некоторое время, обычно в течение полминуты, изменения должны будут отразится. 

**Смотрим изменения:**

Да, действительно, изменения произошли. 

Итак, мы с вами разобрали основы конфигурирования приложений в Kubernetes, а также изучили базовые команды для работы с объектами ConfigMap и Secret. 