Kubectl - это утилита, которая позволяет управлять кластером Kubernetes. kubectl можно использовать для развертывания приложений, проверки и управления ресурсов кластера, а также для просмотра логов.

Kubectl работает как клиент к API Server-y, т.е. все команды в конечном итоге превращаются в запросы к API Server-y, поэтому необходимо, чтобы kubectl был сконфигурирован и имел доступ к API Server. 

Kubectl устанавливается и настраивается на рабочей машине пользователя. В инсталляции катакоды kubectl уже предустановлен и настроен. Подробнее про установку, настройку и конфигурирование kubectl можно прочитать в официальной документации. 

Проверить, настроен ли kubectl, можно с помощью команды kubectl cluster-info. 

**Запустим команду**

Да, действительно kubectl настроен. 

Поскольку конфигурирование и работа с кластером представляет собой работу с *объектами* Kubernetes, то kubectl заточен под работу с ними. 

Как мы знаем, для каждого *объекта* Kubernetes есть соответствующий ресурс API. Чтобы посмотреть список всех зарегистрированных ресурсов и соответствующих им типов объектов, можно запустить команду kubectl api-resources. 

**Запускаем команду**

Как видим, ресурсов и типов объектов довольно много. И каждому ресурсу однозначно соответствует объект.

Теперь давайте посмотрим, как можно получить список объектов определенного типа. 

Для этого можно использовать команду `kubectl get {название ресурса}` Она выведет список всех объектов, соответствующих данному ресурсу.

Чтобы получить список нод, **запустим команду** kubectl get nodes. Видим, что у нас 2 объекта типа Node - controlplane и node01. Оба в статусе Ready. 

Или, мы можем получить список компонентстатусов. Это объекты, которые показывают статус основных управляющих компонентов Kubernetes, за исключением собственно апи сервера, через который делается запрос. 

**Запускаем команду.** Видим, что все компоненты живы и работают. 

Или мы можем получить список пространств имен. Пространство имен - namespace - это тоже объект Kubernetes.

**Запускаем команду** kubectl get namespaces. 

Видим с вами несколько пространств имен. Это системные неймспейсы. Например, в неймспейсе kube-system запущены управляющие компоненты. 

Для того, чтобы получить только один объект в табличном виде можно использовать команду `kubectl get {название ресурса} {имя ресурса}`

Давайте с вами посмотрим, как это выглядит.

Получим информацию о ноде controlplane в табличном виде. **Запускаем команду**  `kubectl get node controlplane`

Вывод у этой команды не очень информативный. Чтобы получить не табличное, а полноценное представление объекта в **json** или **yaml** формате, надо передать параметры `-o json` или `-o yaml`. 

**Запускаем команду**`kubectl get node controlplane -o json`  Видим намного больше информации. Фактически это тот самый вывод, который мы с вами получали, когда делали напрямую запросы к апи-серверу. 

И тоже самое в yaml формате. **Запускаем команду.** 

Чтобы получить расширенное, человекочитаемое описание объекта, можно использовать команду `kubectl describe {название ресурса} {имя ресурса}`

Т.е. для controlplane ноды эта будет команда `kubectl describe node controlplane`. 

**Запускаем ее** 

Название ресурса в командах можно использовать как во множественном числе, так и в единственном. Т.е. команды `kubectl get node` и `kubectl get nodes` идентичны. 

Также можно использовать сокращения. Например, **no** вместо **nodes**, **ns** вместо **namespace** и т.д. Т.е. команды `kubectl get no` и `kubectl get node` идентичны.

**Запустим команду** `kubectl get no` 

Получаем список нод. 

И также можно получить список неймспейсов или конкретный ресурс. 

**Запустим команды**

Не для всех ресурсов есть сокращения, а чтобы посмотреть для кого есть и каковы они, можно посмотреть в колонке shortnames команды `kubectl api-resources`. 

**Запустим еще раз команду** kubectl api-resources. 

В колонке shortnames видим сокращения для разных ресурсов. 

Также можно получить несколько ресурсов за раз, перечислив их через запятую. 

**Запустим команду**`kubectl get no,ns`

Увидим с вами 2 списка ресурсов - нод и неймспейсов. 

## Пространства имен

Часть ресурсов привязываются к пространству имен, а часть - нет.  Те объекты, которые отвечают за "глобальные" части кластера или, например, сильно связаны с инфраструктурой, как объекты типа **Node** и **Namespace** вынесены из пространств имен. 

Узнать, какие ресурсы привязаны, а какие нет, можно посмотреть в колонке namespaced = True/False, вывода команды kubectl api-resources. 

Поскольку namespaced объектам для идентификации недостаточно только имени объекта, потому что оно уникально только в рамках пространства имен. Поэтому в общем случае для получения таких объектов необходимо еще и передавать пространство имен. Чтобы указать пространство имен нужно в kubectl передавать параметр -n {имя пространства имен}.

Например, объекты типа **Pod**, привязываются к пространству имен. Чтобы получить список подов или конкретный под, нужно еще и указать неймспейс. 

**Запустим команду** kubectl get pod -n kube-system

Получим список всех подов в нейспейсе kube-system. Их будет довольно много. 

А если  **запустим команду** kubectl get pod -n default, увидим, что в неймспейсе default ни одного пода нет. 

Конечно же, каждый раз передавать неймспейс для namespaced ресурсов утомительно, поэтому в настройках kubectl есть namespace по умолчанию. Если параметр -n не передан в команду kubectl, то используется namespace по умолчанию. По умолчанию используется **namespace** с именем `default`.

Т.е. запуск команд kubectl get pod и kubectl get pod -n default сейчас идентичны. 

Изменить текущий namespace можно с помощью команды kubectl config. 

Давайте сделаем неймспейсом по умолчанию kube-system. **Запустим команду.**  

**Запустим команду** kubectl get pod без параметра -n.

И видим список подов из неймспейса kube-system.

Итак, в этой демонстрации мы с вами узнали базовые команды утилиты kubectl и научились получать информацию о ресурсах kubernetes. В следующей демонстрации мы узнаем как создавать, обновлять и удалять объекты с помощью kubectl.

