Конфигурация и состояние кластера Kubernetes разбита на небольшие описания - объекты различных типов. Каждый объект описывает какой-то небольшой аспект кластера, например, запущенный инстанс сервиса или ноду кластера. Все объекты хранятся в хранилище etcd, а доступ к ним осуществляется через api-server.

Если посмотрим на то, какие запросы делаются в api-server, то увидим, что это REST запросы, которые делаются к ресурсам в REST терминологии. И запрос, который мы с вами делали для того, чтобы запустить контейнер в кластере, это был запрос на создание ресурса pod. А в тело запроса передавался объект типа Pod. Объект типа Pod является описание простейшей рабочей нагрузки. Сам ресурс и объект типа Pod мы с вами рассмотрим чуть позже, а сейчас посмотрим тело запроса:

`cat ./hello-service.json | jq `{{execute T1}}

Как и у любого объекта у объекта типа Pod есть атрибуты: apiVersion, metadata, spec.

Также мы можем получить информацию о нашем объекте с помощью GET запроса к ресурсу pod по его имени:

`curl -s 127.0.0.1:8080/api/v1/namespaces/default/pods/hello-demo | jq`{{execute T1}}

Как видим там содержится много информации, в том числе и атрибут - status, который отражает текущий статус объекта.

Можно посмотреть, как эта же информация хранится в etcd:

`docker exec -it $ETCD_DOCKER_ID etcdctl get /registry/pods/default/hello-demo  --cacert /etc/kubernetes/pki/etcd/ca.crt --cert /etc/kubernetes/pki/etcd/peer.crt  --key /etc/kubernetes/pki/etcd/peer.key`{{execute T1}}

Так же мы можем удалить ресурс с помощью DELETE метода, что полностью соответсвует REST стандарту.

`curl -X DELETE 127.0.0.1:8080/api/v1/namespaces/default/pods/hello-demo`{{execute T1}}

Когда мы так сделаем, то GET запрос будет уже выдавать 404-ую ошибку:

`curl 127.0.0.1:8080/api/v1/namespaces/default/pods/hello-demo | jq`{{execute T1}}

А контейнер будет потушен:

`docker ps | grep -v pause | grep hello`{{execute T2}}

Конечно же редко кто делает запросы напрямую к api-server-у, да и json формат не очень удобен для использования людьми. Мы с вами проделывали эти все запросы лишь с целью демонстрации того, как устроен Kubernetes внутри.

